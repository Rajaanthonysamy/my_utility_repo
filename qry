def extract_bucket_chunks(bucket_json):
    bucket_chunks = []
    bucket_metadatas = []

    for bucket_name, bucket_info in bucket_json.items():
        bucket_desc = bucket_info.get("description", "")
        examples = bucket_info.get("example_queries", [])

        # Combine all examples in a single chunk
        example_texts = []
        for idx, example in enumerate(examples):
            uq = example.get("user_question", "")
            qd = example.get("query_description", "")
            sq = example.get("query", "")
            example_texts.append(
                f"Example {idx+1}:\nUser Question: {uq}\nQuery Description: {qd}\nSPARQL Query: {sq}"
            )

        full_text = f"Bucket: {bucket_name}\nDescription: {bucket_desc}\n\n" + "\n\n".join(example_texts)

        bucket_chunks.append(full_text.strip())

        # Metadata
        bucket_metadatas.append({
            "doc_type": "query_bucket",
            "bucket_name": bucket_name,
            "num_examples": len(examples)
        })

    return bucket_chunks, bucket_metadatas
