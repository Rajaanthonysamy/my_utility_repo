def extract_bucket_chunks(bucket_json):
    bucket_chunks = []
    bucket_metadatas = []

    for bucket_name, bucket_info in bucket_json.items():
        bucket_desc = bucket_info.get("description", "")

        for idx, example in enumerate(bucket_info.get("example_queries", [])):
            text = (
                f"Bucket: {bucket_name}\n"
                f"Description: {bucket_desc}\n"
                f"User Question: {example['user_question']}\n"
                f"Query Description: {example['query_description']}\n"
                f"SPARQL Query: {example['query']}"
            )
            bucket_chunks.append(text.strip())

            bucket_metadatas.append({
                "doc_type": "query_bucket",
                "bucket_name": bucket_name,
                "example_id": idx,
                "user_question": example["user_question"],
                "query_description": example["query_description"],
                "query": example["query"]
            })

    return bucket_chunks, bucket_metadatas
